!function(e){function t(e,t){this.opt=this.extend({},this["default"],t),this.$element=document.getElementById(e),this.el=e,this.init(),this.bind()}var n,i,o;i=function(e){return"[object Object]"===Object.prototype.toString.call(e)},n=function(e,t){var n;for(n in e)if(e.hasOwnProperty(n)){if(i(e[n])&&i(t[n])&&arguments.callee(e[n],t[n]),t.hasOwnProperty(n))continue;t[n]=e[n]}},o=function(e,t){var n=t.parentNode;n.lastChild==t?n.appendChild(e):n.insertBefore(e,t.nextSibling)},t.prototype={constructor:t,"default":{len:4,chars:[1,2,3,4,5,6,7,8,9,0,"a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],messageBtnValue:"短信验证码",api:"/JPEGServlet",el:"verificationCode-image",telNum:"",telErrInfo:"请输入正确的手机号",sendMessageApi:"api/",sendMsgData:{},countTime:60,inputArea:"",click2refresh:!0,validateEven:""},extend:function(){var e,t=arguments,o={};if(!t.length)return{};for(e=t.length-1;e>=0;e--)i(t[e])&&n(t[e],o);return t[0]=o,o},trim:function(e){return e.replace(/(^\s*)|(\s*$)/g,"")},append:function(e,t){return e.innerHTML+=t,e},children:function(e,t){var n=e.childNodes,i=[];if(/MSIE(6|7|8)/.test(navigator.userAgent))for(var o=0;o<n.length;o++){var r=n[o];1===r.nodeType&&(i[i.length]=r)}else i=Array.prototype.slice.call(e.children);if("string"==typeof t)for(var s=0;s<i.length;s++)curTag=i[s],curTag.nodeName.toLowerCase()!==t.toLowerCase()&&(i.splice(s,1),s--);return i},init:function(){this.el===this["default"].el?this.append(this.$element,'<input type="text"/><img src="'+this.opt.api+'" alt="图形验证码"/>'):this.append(this.$element,'<input type="text"/><button type="button">'+this.opt.messageBtnValue+"</button>")},bind:function(){var e,t=this;e=t.el===t["default"].el?"img":"button",t.opt.click2refresh&&t.bindHandler(t.children(t.$element,e)[0],"click",function(){t.el===t["default"].el?t.refresh():t.sendMessageCode()})},bindHandler:function(e,t,n){window.addEventListener?e.addEventListener(t,n,!1):window.attachEvent&&e.attachEvent("on"+t,n)},refresh:function(){this.children(this.$element,"img")[0].setAttribute("src",this.opt.api+"?"+Math.random())},sendMessageCode:function(){var e=this.children(this.$element,"input")[0],t=/^1[34578]\d{9}$/;if(t.test(e.value))"BUTTON"!=e.nextSibling.nodeName&&e.nextSibling.remove(),e.style.borderColor="",this.timeCountDown(this.children(this.$element,"button")[0],this.opt.countTime),this.sendMsg();else if("SPAN"!=e.nextSibling.nodeName){var n=document.createElement("span"),i=document.createTextNode(this.opt.telErrInfo);n.appendChild(i),n.style.color="red",o(n,e),e.style.borderColor="red"}},sendMsg:function(){reqwest({url:this.opt.api,type:"json",method:"post",contentType:"application/json",success:function(e){},error:function(e){}})},timeCountDown:function(e,t){var n=null,i={timer:function(){n=setTimeout(arguments.callee,1e3),0===t?(clearTimeout(n),e.removeAttribute("disabled"),e.innerHTML="重新发送"):(e.setAttribute("disabled",!0),e.innerHTML="已发送("+t+"s)",t--)}};i.timer()}},"function"==typeof define?define(function(){return{get:function(){new t(arguments[0],arguments[1])}}}):function(){var e={get:function(){new t(arguments[0],arguments[1])}};window.VerificationCode=e}()}(window);